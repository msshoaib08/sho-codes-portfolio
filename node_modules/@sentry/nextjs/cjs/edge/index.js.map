{"version":3,"file":"index.js","sources":["../../../src/edge/index.ts"],"sourcesContent":["import { applySdkMetadata, registerSpanErrorInstrumentation } from '@sentry/core';\nimport { GLOBAL_OBJ } from '@sentry/utils';\nimport type { VercelEdgeOptions } from '@sentry/vercel-edge';\nimport { getDefaultIntegrations, init as vercelEdgeInit } from '@sentry/vercel-edge';\n\nimport { isBuild } from '../common/utils/isBuild';\nimport { distDirRewriteFramesIntegration } from './distDirRewriteFramesIntegration';\n\nexport type EdgeOptions = VercelEdgeOptions;\n\nconst globalWithInjectedValues = GLOBAL_OBJ as typeof GLOBAL_OBJ & {\n  __rewriteFramesDistDir__?: string;\n};\n\n/** Inits the Sentry NextJS SDK on the Edge Runtime. */\nexport function init(options: VercelEdgeOptions = {}): void {\n  registerSpanErrorInstrumentation();\n\n  if (isBuild()) {\n    return;\n  }\n\n  const customDefaultIntegrations = getDefaultIntegrations(options);\n\n  // This value is injected at build time, based on the output directory specified in the build config. Though a default\n  // is set there, we set it here as well, just in case something has gone wrong with the injection.\n  const distDirName = globalWithInjectedValues.__rewriteFramesDistDir__;\n\n  if (distDirName) {\n    customDefaultIntegrations.push(distDirRewriteFramesIntegration({ distDirName }));\n  }\n\n  const opts = {\n    defaultIntegrations: customDefaultIntegrations,\n    ...options,\n  };\n\n  applySdkMetadata(opts, 'nextjs');\n\n  vercelEdgeInit(opts);\n}\n\n/**\n * Just a passthrough in case this is imported from the client.\n */\nexport function withSentryConfig<T>(exportedUserNextConfig: T): T {\n  return exportedUserNextConfig;\n}\n\nexport * from '@sentry/vercel-edge';\n\nexport * from '../common';\n\nexport { wrapApiHandlerWithSentry } from './wrapApiHandlerWithSentry';\n"],"names":["GLOBAL_OBJ","registerSpanErrorInstrumentation","isBuild","getDefaultIntegrations","distDirRewriteFramesIntegration","applySdkMetadata","vercelEdgeInit"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAUA,MAAM,wBAAA,GAA2BA,gBAAW;;AAE5C,CAAA;AACA;AACA;AACO,SAAS,IAAI,CAAC,OAAO,GAAsB,EAAE,EAAQ;AAC5D,EAAEC,qCAAgC,EAAE,CAAA;AACpC;AACA,EAAE,IAAIC,eAAO,EAAE,EAAE;AACjB,IAAI,OAAM;AACV,GAAE;AACF;AACA,EAAE,MAAM,yBAA0B,GAAEC,iCAAsB,CAAC,OAAO,CAAC,CAAA;AACnE;AACA;AACA;AACA,EAAE,MAAM,WAAA,GAAc,wBAAwB,CAAC,wBAAwB,CAAA;AACvE;AACA,EAAE,IAAI,WAAW,EAAE;AACnB,IAAI,yBAAyB,CAAC,IAAI,CAACC,+DAA+B,CAAC,EAAE,WAAA,EAAa,CAAC,CAAC,CAAA;AACpF,GAAE;AACF;AACA,EAAE,MAAM,OAAO;AACf,IAAI,mBAAmB,EAAE,yBAAyB;AAClD,IAAI,GAAG,OAAO;AACd,GAAG,CAAA;AACH;AACA,EAAEC,qBAAgB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAA;AAClC;AACA,EAAEC,eAAc,CAAC,IAAI,CAAC,CAAA;AACtB,CAAA;AACA;AACA;AACA;AACA;AACO,SAAS,gBAAgB,CAAI,sBAAsB,EAAQ;AAClE,EAAE,OAAO,sBAAsB,CAAA;AAC/B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}