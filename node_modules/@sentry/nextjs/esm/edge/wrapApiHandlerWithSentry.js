import { withEdgeWrapping } from '../common/utils/edgeWrapperUtils.js';

/**
 * Wraps a Next.js edge route handler with Sentry error and performance instrumentation.
 */
function wrapApiHandlerWithSentry(
  handler,
  parameterizedRoute,
) {
  return new Proxy(handler, {
    apply: (wrappingTarget, thisArg, args) => {
      const req = args[0];

      const wrappedHandler = withEdgeWrapping(wrappingTarget, {
        spanDescription: !(req instanceof Request)
          ? `handler (${parameterizedRoute})`
          : `${req.method} ${parameterizedRoute}`,
        spanOp: 'http.server',
        mechanismFunctionName: 'wrapApiHandlerWithSentry',
      });

      return wrappedHandler.apply(thisArg, args);
    },
  });
}

export { wrapApiHandlerWithSentry };
//# sourceMappingURL=wrapApiHandlerWithSentry.js.map
